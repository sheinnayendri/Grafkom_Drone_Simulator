<html>
<head>
    <title>Final Project - OK</title>

    <style>
    	body{
    		margin: 0;
    		overflow: hidden;
    	}
    </style>
</head>
<body>

    <canvas id="myCanvas"></canvas>

    <script src="three.js"></script>
    <script src="GLTFLoader.js"></script>

    <script>
    var music = new Audio("sound/If_I_Had_a_Chicken.mp3");

    var player = { height:1.0}
    var renderer,
    	scene,
    	camera,
    	myCanvas = document.getElementById('myCanvas');

    //RENDERER
    renderer = new THREE.WebGLRenderer({
      canvas: myCanvas, 
      antialias: true
    });
    renderer.setClearColor(0x55e7ff);
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(window.innerWidth, window.innerHeight);

    //CAMERA
    camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000 );

    camera.position.set(0, 80, 50);
  //  camera.position.set(50, 40, 30);
    camera.lookAt(new THREE.Vector3(0,0,0)); 

    //SCENE
    scene = new THREE.Scene();

    //GROUND PLANE
    var planeGeometry = new THREE.PlaneGeometry(100,100,100,100); 
    var planeMaterial = new THREE.MeshBasicMaterial({color: 0x2a6002, wireframe:false}); 
    plane = new THREE.Mesh(planeGeometry,planeMaterial);
    plane.rotation.x -= Math.PI / 2;
    scene.add( plane );

    //LIGHTS
    var light = new THREE.AmbientLight(0xffffff, 0.5);
    scene.add(light);

    var light2 = new THREE.PointLight(0xffffff, 0.5);
    scene.add(light2);
  
    //FOG
    // scene.fog=new THREE.FogExp2( 0xffffff, 0.01 );

    var loader = new THREE.GLTFLoader();

    loader.load('objects/pine_tree/scene.gltf', handle_tree);
    loader.load('objects/pine_tree/scene.gltf', handle_tree1);
    loader.load('objects/pine_tree/scene.gltf', handle_tree11);
    loader.load('objects/pine_tree/scene.gltf', handle_tree111);
    loader.load('objects/pine_tree/scene.gltf', handle_tree1111);
    loader.load('objects/pine_tree/scene.gltf', handle_tree11111);
    loader.load('objects/pine_tree/scene.gltf', handle_tree111111);
    loader.load('objects/pine_tree/scene.gltf', handle_tree1111111);
    loader.load('objects/glb/tree_sheinna1.glb', handle_tree2);
    loader.load('objects/glb/tree_sheinna2.glb', handle_tree3);
    loader.load('objects/apple_tree/scene.gltf', handle_tree4);
    loader.load('objects/apple_tree/scene.gltf', handle_tree41);
    loader.load('objects/pine_tree/scene.gltf', handle_tree5);
    loader.load('objects/pine_tree/scene.gltf', handle_tree51);
    loader.load('objects/pine_tree/scene.gltf', handle_tree511);
    loader.load('objects/pine_tree/scene.gltf', handle_tree5111);
    loader.load('objects/simple_tree/scene.gltf', handle_tree6);
    loader.load('objects/simple_tree/scene.gltf', handle_tree61);
    loader.load('objects/simple_tree/scene.gltf', handle_tree611);
    loader.load('objects/spruce_tree/scene.gltf', handle_tree7);
    loader.load('objects/spruce_tree2/scene.gltf', handle_tree8);
    loader.load('objects/spruce_tree2/scene.gltf', handle_tree81);
    loader.load('objects/bench/scene.gltf', handle_bench);
    loader.load('objects/bench/scene.gltf', handle_bench1);
    loader.load('objects/bench/scene.gltf', handle_bench2);
    loader.load('objects/rocks/scene.gltf', handle_rocks);

    loader.load('objects/yulia/store.glb', handle_build1);
    loader.load('objects/yulia/store.glb', handle_build11);
    loader.load('objects/yulia/store3.glb', handle_build12);
    loader.load('objects/yulia/building.glb', handle_build2);
    loader.load('objects/yulia/building.glb', handle_build21);
    loader.load('objects/yulia/building2.glb', handle_build22);
    loader.load('objects/yulia/Apartment.glb', handle_build3);
    loader.load('objects/yulia/gedung.glb', handle_build4);
    loader.load('objects/yulia/gedung.glb', handle_build41);
    loader.load('objects/yulia/GasStation.glb', handle_build5);
    loader.load('objects/yulia/Apartment2.glb', handle_build6);
    loader.load('objects/yulia/Apartment2.glb', handle_build61);
    loader.load('objects/yulia/Apartment4.glb', handle_build8);
    loader.load('objects/yulia/Apartment4.glb', handle_build81);
    loader.load('objects/yulia/town.glb', handle_builda11);
  
  
    loader.load('objects/car/car1/scene.gltf', handle_car1);
    loader.load('objects/car/car1/scene.gltf', handle_car11);
    // loader.load('objects/car/car2/scene.gltf', handle_car2);
    // loader.load('objects/car/car3/scene.gltf', handle_car3);


    var mesh, bench_mesh, cloud_mesh, rocks_mesh;

    //load biasa
    function handle_load(gltf, x, y, z,sc, mesh) {
        console.log(gltf);
        mesh = gltf.scene;
        console.log(mesh.children[0]);
        mesh.children[0].material = new THREE.MeshLambertMaterial();
        mesh.scale.set(sc, sc, sc);    
        mesh.position.z = z;
        mesh.position.x = x;
        mesh.position.y = y;
		scene.add( mesh );
    }
    
    // ada rotate x, y
    function handle_load2(gltf, x, y, z,xr, yr, sc, mesh) {
        console.log(gltf);
        mesh = gltf.scene;
        console.log(mesh.children[0]);
        mesh.children[0].material = new THREE.MeshLambertMaterial();
        mesh.scale.set(sc, sc, sc);    
        mesh.position.z = z;
        mesh.position.x = x;
        mesh.position.y = y;
        mesh.rotation.x = xr;
        mesh.rotation.y = yr;
		scene.add( mesh );
    }

    //ada scale x,y,z
    function handle_load3(gltf, x, y, z,xr, yr, sca, scb, scc, mesh) {
        console.log(gltf);
        mesh = gltf.scene;
        console.log(mesh.children[0]);
        mesh.children[0].material = new THREE.MeshLambertMaterial();
        mesh.scale.set(sca, scb, scc);    
        mesh.position.z = z;
        mesh.position.x = x;
        mesh.position.y = y;
        mesh.rotation.x = xr;
        mesh.rotation.y = yr;
		scene.add( mesh );
    }


    // x makin kanan makin negatif
    // z makin depan makin negatif
   
    //pabrik pojok kanan belakang
    function handle_builda11(gltf) {
        handle_load2(gltf, -30, 0, 5, 0, 1.58, 0.006, mesh);
    }
    function handle_tree611(gltf) {
        handle_load(gltf, -30, +0, 10, 0.5, mesh);
    }
    function handle_tree41(gltf) {
        handle_load(gltf, -40, +0, 10, 1, mesh);
    }
    function handle_bench1(gltf) {
        handle_load2(gltf, -28, +0.5, 8.5, 0, Math.PI, 1, bench_mesh);
    }
    function handle_bench2(gltf) {
        handle_load2(gltf, -23, +0.5, 8.5, 0, Math.PI, 1, bench_mesh);
    }


    // komplek 1 random
    // daun lebar
    function handle_tree6(gltf) {
        handle_load(gltf, +30, +0, -12, 0.3, mesh);
    }
    function handle_rocks(gltf) {
        handle_load(gltf, 30, +0, -10, 1, rocks_mesh);
    }
    function handle_bench(gltf) {
        handle_load(gltf, 30, +0.5, -13, 1, bench_mesh);
    }
    //jamur
    function handle_tree3(gltf) {
        handle_load(gltf, 35, +0, -10, 1, mesh);
    }



    // komplek 2
    //gas station
    function handle_build5(gltf) {
        handle_load2(gltf, 15, 0, -7, 0, 4.72, 0.005, mesh);
    }
    //gedung pink 2
    function handle_build21(gltf) {
        handle_load2(gltf, 18.8, 0, -10, 0, 1.6, 2, mesh);
    }
    function handle_car1(gltf) {
        handle_load2(gltf, 10, -0.3, -8, 0, 0,  1, mesh);
    }
    function handle_tree4(gltf) {
        handle_load(gltf, 8, +0, -10, 1, mesh);
    }
    function handle_tree8(gltf) {
        handle_load(gltf, 6.5, +0, -10, 2, mesh);
    }

    // komplek 2 belakang
    //gedung kecil
    function handle_build81(gltf) {
        handle_load2(gltf, 23, 0, 13.5, 0, 0, 0.00007, mesh);
    }
    function handle_build11(gltf) {
        handle_load2(gltf, 15, 0, 13, 0, 1.58, 0.22, mesh);
    }
    //gedung pink 2
    function handle_car11(gltf) {
        handle_load2(gltf, 10, -0.3, 12, 0, 0,  1, mesh);
    }
    function handle_tree61(gltf) {
        handle_load(gltf, 8, +0, 10, 0.5, mesh);
    }
    function handle_build61(gltf) {
        handle_load2(gltf, 13, 0, 19, 0, Math.PI, 0.00007, mesh);
    }
    function handle_build41(gltf) {
        handle_load(gltf, 24, -0.3, 20, 0.015, mesh);
    }
    function handle_tree81(gltf) {
        handle_load(gltf, 19.5, +0, 21, 3, mesh);
    }

    // komplek3
    //store
    function handle_build1(gltf) {
        handle_load2(gltf, -7.9, +0.1, -10, 0, 1.58, 0.22, mesh);
    }
    //gedung pink
    function handle_build2(gltf) {
        handle_load2(gltf, -13, 0, -10, 0, 1.6,  2, mesh);
    }
    //apartement
    function handle_build3(gltf) {
        handle_load2(gltf, -13, 0, -5, 0, 1.6, 0.00005, mesh);
    }
    //gedung kecil
    function handle_build4(gltf) {
        handle_load(gltf, -3, -0.3, -10, 0.015, mesh);
    }
    function handle_tree5(gltf) {
        handle_load(gltf, -17, +0, -13, 0.7, mesh);
    }
    function handle_tree51(gltf) {
        handle_load(gltf, -17, +0, -10, 0.7, mesh);
    }
    function handle_tree511(gltf) {
        handle_load(gltf, -17, +0, -7, 0.7, mesh);
    }
    function handle_tree5111(gltf) {
        handle_load(gltf, -17, +0, -4, 0.7, mesh);
    }
    function handle_tree7(gltf) {
        handle_load(gltf, 0.6, +0, -10, 0.7, mesh);
    } 

    //KOMPLEK 3 BELAKANG
    function handle_build22(gltf) {
        handle_load2(gltf, -10, 0, 11, 0, 1.6,  0.025, mesh);
    }
    function handle_build12(gltf) {
        handle_load3(gltf, -3, 0.01, 11, 0, 1.58, 0.25, 0.35, 0.25, mesh);
    }


    //komplek4
    //appatrmtmen2
    function handle_build6(gltf) {
        handle_load2(gltf, -29, 0, -10, 0, 1.6, 0.00007, mesh);
    }
    // appartmnet4
    function handle_build8(gltf) {
        handle_load2(gltf, -37.5, 0, -10, 0, 1.6, 0.00007, mesh);
    }
    function handle_tree(gltf) {
        handle_load(gltf, -23.5, -0.3, -13, 0.7, mesh);
    }
    function handle_tree1(gltf) {
        handle_load(gltf, -23.5, -0.3, -10, 0.7, mesh);
    }
    function handle_tree11(gltf) {
        handle_load(gltf, -23.5, -0.3, -7, 0.7, mesh);
    }
    function handle_tree111(gltf) {
        handle_load(gltf, -23.5, -0.3, -4, 0.7, mesh);
    }
    function handle_tree1111(gltf) {
        handle_load(gltf, -27.5, -0.3, -4, 0.7, mesh);
    }
    function handle_tree11111(gltf) {
        handle_load(gltf, -31.5, -0.3, -4, 0.7, mesh);
    }
    function handle_tree111111(gltf) {
        handle_load(gltf, -35.5, -0.3, -4, 0.7, mesh);
    }
    function handle_tree1111111(gltf) {
        handle_load(gltf, -39.5, -0.3, -4, 0.7, mesh);
    }
    function handle_tree2(gltf) {
        handle_load(gltf, -28, 0, -15, 1, mesh);
    }

    // var mouse = {x:0,y:0};
    var cameraMoves = {x:0,y:0,z:-0.1,move:false,speed:0.2};


    //RENDER LOOP
    render();

    // function mouseMove(e){
    //     if (e.clientX>mouse.x) { camera.position.x += cameraMoves.speed; } else { camera.position.x += -cameraMoves.speed; }
    //     if (e.clientY>mouse.y) { camera.position.y += -cameraMoves.speed; } else { camera.position.y += cameraMoves.speed; }

    //     mouse.x = e.clientX;
    //     mouse.y = e.clientY;
    // }
    // window.addEventListener('mousemove', mouseMove);

    var delta = 0;
    var prevTime = Date.now();

    function render() {
        var delta = 0.01;
        var yawMove = 0.001;
        document.addEventListener('keydown',onDocumentKeyDown,false);
        function onDocumentKeyDown(event){
            event = event || window.event;
            var keycode = event.keyCode;
            switch(keycode){
                // Case MOVE
                case 65 : //A Left
                    camera.position.x = camera.position.x - delta;
                    break;
                case 87 : //W Up
                    camera.position.z = camera.position.z - delta;
                    break;
                case 68 : //D Right
                    camera.position.x = camera.position.x + delta;
                    break;
                case 83 : //S Down
                    camera.position.z = camera.position.z + delta;
                    break;
                case 82 : //R Far
                    camera.position.y = camera.position.y + delta;
                    break;
                case 70 : //F Near 
                    camera.position.y = camera.position.y - delta;
                    break;
                // Case YAW
                case 37 : //arrowLeft
                    camera.rotation.y = camera.rotation.y + yawMove;
                    break;
                case 39 : //arrowRight
                    camera.rotation.y = camera.rotation.y - yawMove;
                    break;
                // Case PITCH
                case 38 : //arrowUp
                    camera.rotation.x = camera.rotation.x + yawMove;
                    break;
                case 40 : //arrowDown
                    camera.rotation.x = camera.rotation.x - yawMove;
                    break;
            }
            document.addEventListener('keyup',onDocumentKeyUp,false);
            music.play();
        }
        function onDocumentKeyUp(event){
            document.removeEventListener('keydown',onDocumentKeyDown,false);
        }
        // if (mesh) mesh.rotation.y += 0.01;
        // if (mesh2) mesh2.rotation.y += 0.01;
        // if (mesh3) mesh3.rotation.y += 0.01;
        // if (bench_mesh) bench_mesh.rotation.y += 0.01;
    	renderer.render(scene, camera);
    	requestAnimationFrame(render);
    }
    </script>
</body>
</html>
